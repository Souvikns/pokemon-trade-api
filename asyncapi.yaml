asyncapi: 3.0.0
info:
  title: Pokemon Trading API
  description: This API helps users to trade pokemons
  version: 0.0.1
servers:
  socketio:
    host: localhost:8080/events
    protocol: ws
channels:
  TradeList:
    description: To list all the open trade of a specific game.
    address: trade
    messages:
      tradeList:
        $ref: '#/components/messages/tradeList'
    servers:
      - $ref: '#/servers/socketio'
  OpenTrade:
    description: open a new trade.
    address: new
    messages:
      openTrade:
        $ref: '#/components/messages/newTrade'
    servers:
      - $ref: '#/servers/socketio'
  CloseTrade:
    description: Close the trade once the trade is successfully completed.
    address: close
    messages:
      closeTrade:
        $ref: '#/components/messages/closeTrade'
    servers:
      - $ref: '#/servers/socketio'
operations:
  fetchTradeList:
    action: receive
    channel:
      $ref: '#/channels/TradeList'
    messages:
      - $ref: '#/channels/TradeList/messages/tradeList'
  openNewTrade:
    action: send
    channel:
      $ref: '#/channels/OpenTrade'
    messages:
      - $ref: '#/channels/OpenTrade/messages/openTrade'
  closeTrade:
    action: send
    channel:
      $ref: '#/channels/CloseTrade'
    messages:
      - $ref: '#/channels/CloseTrade/messages/closeTrade'
components:
  messages:
    tradeList:
      payload:
        type: array
        items:
          type: object
          properties:
            id:
              type: string
            game:
              type: string
              enum:
                - SV
                - SWSH
                - BDSP
            pokemon:
              type: string
            want:
              type: string
    newTrade:
      payload:
        type: object
        properties:
          game:
            type: string
            enum:
              - SV
              - SWSH
              - BDSP
          pokemon:
            type: string
          want:
            type: string
    closeTrade:
      payload:
        type: object
        properties:
          id:
            type: string